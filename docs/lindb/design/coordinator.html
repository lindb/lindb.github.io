<!DOCTYPE html><html lang="en" class="dark [--scroll-mt:9.875rem] [scrollbar-gutter:stable] lg:[--scroll-mt:6.3125rem]"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>Coordinator - Lin</title><meta name="next-head-count" content="3"/><link rel="icon" href="/img/logo.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/instantsearch.css@8/themes/satellite-min.css"/><script>
                try {
                  if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
                    document.documentElement.classList.add('dark')
                    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0B1120')
                  } else {
                    document.documentElement.classList.remove('dark')
                  }
                } catch (_) {}
              </script><link rel="preload" href="/_next/static/css/ce4bca7d4b222059.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ce4bca7d4b222059.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-fe2d641fe691b132.js" defer=""></script><script src="/_next/static/chunks/framework-dab82874eb842bd1.js" defer=""></script><script src="/_next/static/chunks/main-1448cbf9d2b223a1.js" defer=""></script><script src="/_next/static/chunks/pages/_app-13f13594fc30dab1.js" defer=""></script><script src="/_next/static/chunks/pages/docs/%5B%5B...slug%5D%5D-d4746155604a7421.js" defer=""></script><script src="/_next/static/-NtRW_Tocke_77ve0GfWf/_buildManifest.js" defer=""></script><script src="/_next/static/-NtRW_Tocke_77ve0GfWf/_ssgManifest.js" defer=""></script></head><body class="flex min-h-screen flex-col bg-white text-slate-500 antialiased dark:bg-slate-900 dark:text-slate-400"><div id="__next"><div class="pointer-events-none absolute inset-x-0 top-0 flex justify-center overflow-hidden"><div class="flex w-[108rem] flex-none justify-end"><picture><source srcSet="/_next/static/media/docs@30.8b9a76a2.avif" type="image/avif"/><img src="/_next/static/media/docs@tinypng.d9e4dcdc.png" alt="" class="w-[71.75rem] max-w-none flex-none dark:hidden" decoding="async"/></picture><picture><source srcSet="/_next/static/media/docs-dark@30.1a9f8cbf.avif" type="image/avif"/><img src="/_next/static/media/docs-dark@tinypng.1bbe175e.png" alt="" class="hidden w-[90rem] max-w-none flex-none dark:block" decoding="async"/></picture></div></div><div class="flex min-h-screen flex-col"><header class="sticky top-0 z-40 w-full flex-none bg-white leading-8 lg:z-50 lg:border-b lg:border-slate-900/10 lg:bg-white/75 lg:backdrop-blur-sm dark:border-slate-50/[0.06] dark:bg-slate-900 lg:dark:bg-transparent"><div class="mx-auto max-w-8xl"><div class="mx-4 border-b border-slate-900/10 py-3 lg:mx-0 lg:border-0 lg:px-8 lg:py-4 dark:border-slate-300/10"><div class="relative flex items-center"><div class="relative ml-auto flex flex-1 items-center"><nav class="flex flex-1 items-center text-sm font-semibold leading-6 text-slate-700 dark:text-slate-200"><a target="_self" href="/"><img src="/img/logo.svg" alt="Lin Labs Logo" class="size-7"/></a><div class="hidden lg:ml-16 lg:block"><ul class="flex space-x-6"><div data-headlessui-state=""><button class="font-semibold  focus:outline-none data-[hover]:text-sky-500 dark:data-[hover]:text-sky-400" type="button" aria-expanded="false" data-headlessui-state="">Open source</button></div><div hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></div><li class="hover:cursor-pointer"><a target="_self" class="hover:text-sky-500 dark:hover:text-sky-400" href="/docs/lindb/introduction">Docs</a></li><li class="hover:cursor-pointer"><a target="_self" class="hover:text-sky-500 dark:hover:text-sky-400" href="/downloads/lindb">Downloads</a></li></ul></div></nav><div class="flex items-center gap-4"><button class="flex items-center" id="headlessui-menu-button-:R1pj6:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5"><path fill-rule="evenodd" d="M9 2.25a.75.75 0 0 1 .75.75v1.506a49.384 49.384 0 0 1 5.343.371.75.75 0 1 1-.186 1.489c-.66-.083-1.323-.151-1.99-.206a18.67 18.67 0 0 1-2.97 6.323c.318.384.65.753 1 1.107a.75.75 0 0 1-1.07 1.052A18.902 18.902 0 0 1 9 13.687a18.823 18.823 0 0 1-5.656 4.482.75.75 0 0 1-.688-1.333 17.323 17.323 0 0 0 5.396-4.353A18.72 18.72 0 0 1 5.89 8.598a.75.75 0 0 1 1.388-.568A17.21 17.21 0 0 0 9 11.224a17.168 17.168 0 0 0 2.391-5.165 48.04 48.04 0 0 0-8.298.307.75.75 0 0 1-.186-1.489 49.159 49.159 0 0 1 5.343-.371V3A.75.75 0 0 1 9 2.25ZM15.75 9a.75.75 0 0 1 .68.433l5.25 11.25a.75.75 0 1 1-1.36.634l-1.198-2.567h-6.744l-1.198 2.567a.75.75 0 0 1-1.36-.634l5.25-11.25A.75.75 0 0 1 15.75 9Zm-2.672 8.25h5.344l-2.672-5.726-2.672 5.726Z" clip-rule="evenodd"></path></svg></button><button class="flex items-center" id="headlessui-menu-button-:R1qj6:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5 fill-sky-400/20 stroke-sky-500 dark:hidden "><path d="M12 2.25a.75.75 0 0 1 .75.75v2.25a.75.75 0 0 1-1.5 0V3a.75.75 0 0 1 .75-.75ZM7.5 12a4.5 4.5 0 1 1 9 0 4.5 4.5 0 0 1-9 0ZM18.894 6.166a.75.75 0 0 0-1.06-1.06l-1.591 1.59a.75.75 0 1 0 1.06 1.061l1.591-1.59ZM21.75 12a.75.75 0 0 1-.75.75h-2.25a.75.75 0 0 1 0-1.5H21a.75.75 0 0 1 .75.75ZM17.834 18.894a.75.75 0 0 0 1.06-1.06l-1.59-1.591a.75.75 0 1 0-1.061 1.06l1.59 1.591ZM12 18a.75.75 0 0 1 .75.75V21a.75.75 0 0 1-1.5 0v-2.25A.75.75 0 0 1 12 18ZM7.758 17.303a.75.75 0 0 0-1.061-1.06l-1.591 1.59a.75.75 0 0 0 1.06 1.061l1.591-1.59ZM6 12a.75.75 0 0 1-.75.75H3a.75.75 0 0 1 0-1.5h2.25A.75.75 0 0 1 6 12ZM6.697 7.757a.75.75 0 0 0 1.06-1.06l-1.59-1.591a.75.75 0 0 0-1.061 1.06l1.59 1.591Z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="hidden size-5 fill-sky-400/20 stroke-sky-500 dark:inline"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg></button><a target="_blank" class="block text-slate-600 hover:text-slate-700 dark:text-gray-200 dark:hover:text-slate-300" href="https://github.com/lindb/lindb"><span class="sr-only">LinDB on GitHub</span><svg viewBox="0 0 16 16" class="size-5" fill="currentColor" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a><div class="w-32 lg:w-48"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="-my-1 lg:hidden"><button type="button" class="flex size-5 items-center justify-center text-slate-500 hover:text-slate-600 dark:text-slate-400 dark:hover:text-slate-300"><span class="sr-only">Navigation</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></button></div></div></div></div></div></div></header><div class="sticky top-[3.3rem] z-50 flex items-center border-b border-slate-900/10 bg-white p-4 leading-6 lg:hidden lg:bg-white/75 lg:backdrop-blur-sm dark:border-slate-50/[0.06] dark:bg-slate-900 lg:dark:bg-transparent"><button type="button" class="text-slate-500 hover:text-slate-600 dark:text-slate-400 dark:hover:text-slate-300"><span class="sr-only">Navigation</span><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-6"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg></button><ol class="ml-4 flex min-w-0 whitespace-nowrap text-sm leading-6"><li class="flex items-center">Design<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-5"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></li><li class="truncate font-semibold text-slate-900 dark:text-slate-200">Coordinator</li></ol></div><main class="flex flex-1 pt-4"><div class="mx-auto flex max-w-8xl flex-1 flex-col px-4 sm:px-6 md:px-8"><div><div class="z-20 w-52 overflow-y-auto pb-10 lg:block xl:w-[19rem] hidden pl-8 fixed inset-0 left-[max(0px,calc(50%-45rem))] right-auto top-[3.8125rem]"><nav class="relative pt-5 lg:text-sm lg:leading-6"><ul><li><a target="_self" class="group mb-4 flex items-center font-semibold lg:text-sm lg:leading-6 text-slate-900 dark:text-slate-200 hover:text-slate-900  dark:hover:text-slate-300" href="/docs/lindb/introduction"><div class="mr-4 rounded-md p-1 shadow-sm ring-1 ring-slate-900/5 group-hover:shadow group-hover:shadow-violet-200 group-hover:ring-slate-900/10 dark:bg-slate-800 dark:shadow-none dark:ring-0 dark:group-hover:shadow-slate-400"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-4 fill-cyan-500 group-hover:fill-cyan-600"><path d="M11.25 4.533A9.707 9.707 0 0 0 6 3a9.735 9.735 0 0 0-3.25.555.75.75 0 0 0-.5.707v14.25a.75.75 0 0 0 1 .707A8.237 8.237 0 0 1 6 18.75c1.995 0 3.823.707 5.25 1.886V4.533ZM12.75 20.636A8.214 8.214 0 0 1 18 18.75c.966 0 1.89.166 2.75.47a.75.75 0 0 0 1-.708V4.262a.75.75 0 0 0-.5-.707A9.735 9.735 0 0 0 18 3a9.707 9.707 0 0 0-5.25 1.533v16.103Z"></path></svg></div>Introduction</a></li><li><a target="_self" class="group mb-4 flex items-center font-semibold lg:text-sm lg:leading-6 text-slate-900 dark:text-slate-200 hover:text-slate-900  dark:hover:text-slate-300" href="/docs/lindb/release-notes"><div class="mr-4 rounded-md p-1 shadow-sm ring-1 ring-slate-900/5 group-hover:shadow group-hover:shadow-violet-200 group-hover:ring-slate-900/10 dark:bg-slate-800 dark:shadow-none dark:ring-0 dark:group-hover:shadow-slate-400"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-4 fill-violet-400 group-hover:fill-violet-500"><path fill-rule="evenodd" d="M9.315 7.584C12.195 3.883 16.695 1.5 21.75 1.5a.75.75 0 0 1 .75.75c0 5.056-2.383 9.555-6.084 12.436A6.75 6.75 0 0 1 9.75 22.5a.75.75 0 0 1-.75-.75v-4.131A15.838 15.838 0 0 1 6.382 15H2.25a.75.75 0 0 1-.75-.75 6.75 6.75 0 0 1 7.815-6.666ZM15 6.75a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" clip-rule="evenodd"></path><path d="M5.26 17.242a.75.75 0 1 0-.897-1.203 5.243 5.243 0 0 0-2.05 5.022.75.75 0 0 0 .625.627 5.243 5.243 0 0 0 5.022-2.051.75.75 0 1 0-1.202-.897 3.744 3.744 0 0 1-3.008 1.51c0-1.23.592-2.323 1.51-3.008Z"></path></svg></div>Releases</a></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">Getting Started</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/getting-started/docker">Docker</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/getting-started/package">Package</a></li></ul></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">Developer Guide</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/developer-guide/connect">Connect</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/developer-guide/create-database">Create a database</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/developer-guide/insert-data">Insert data</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/developer-guide/query-data">Query data</a></li></ul></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">Deployment</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/deployment/kubernetes">Kubernetes</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/deployment/manual">Manual deployment</a></li></ul></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">Client</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/client/cli">CLI</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/client/client-libraries">Client libraries</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/client/go">Go</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/client/java">Java</a></li></ul></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">Lin QL</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/lin-ql/sql">Lin query language</a></li></ul></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">Admin Console</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/admin-console/index">Introduction</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/admin-console/overview">Cluster overview</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/admin-console/search">Data search</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/admin-console/explore">Data explore</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/admin-console/monitoring">Cluster monitoring</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/admin-console/metadata">Metadata</a></li></ul></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">API</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/api/index">Introduction</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/api/insert">Insert</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/api/query">Query</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/api/state">State</a></li></ul></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">Reference</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/reference/data-model">Data Model</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/reference/metric">Metric</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/reference/configuration">Configuration</a></li></ul></li><li class="mt-4"><h5 class="mb-2 font-semibold text-slate-900 lg:mb-3 dark:text-slate-200">Design</h5><ul class="space-y-2 border-l border-slate-100 lg:space-y-2 dark:border-slate-800"><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/architecture">Architecture</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 text-sky-500 border-current font-semibold dark:text-sky-400" href="/docs/lindb/design/coordinator">Coordinator</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/replication">Replication</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/query">Query</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/storage">Storage</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/memory-database">Memory database</a></li><li class=""><a target="_self" class="-ml-px block border-l pl-4 border-transparent hover:border-slate-400 dark:hover:border-slate-500 text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/inverted-index">Inverted index</a></li></ul></li></ul></nav></div></div><div class="flex-1 lg:pl-36 xl:pl-[19.5rem]"><div class="mx-auto max-w-3xl xl:ml-0 xl:mr-[15.5rem] xl:max-w-none xl:pr-16"><header id="header" class="relative border-b border-gray-200 pb-4 dark:border-gray-800 "><div><p class="mb-2 hidden text-sm font-semibold leading-6 text-sky-500 lg:block dark:text-sky-400">Design</p><div class="flex items-center"><h1 class="inline-block text-2xl font-extrabold tracking-tight text-slate-900 sm:text-3xl dark:text-slate-200">Coordinator</h1></div></div><div class="mt-1 text-sm italic">Last updated on<!-- --> <span class="font-medium text-slate-900 underline decoration-sky-500 dark:text-slate-200">Mon Jun 24 07:03:27 2024</span> <!-- -->by<!-- --> <span class="font-medium text-slate-900 underline decoration-sky-500 dark:text-slate-200">stone1100</span></div></header><div id="content-wrapper" class="prose prose-slate relative mt-8 dark:prose-dark"><p>All MetaData modification are mainly executed by three different roles in LinDB.</p>
<ol>
<li><strong>Master</strong>: Execute all Metadata modification and delivery them to other components in the cluster through ETCD, and the Master is elected in Broker;</li>
<li><strong>Broker</strong>: Listens all states in the cluster;</li>
<li><strong>Storage</strong>: Listens status of the storage cluster where its located;</li>
</ol>
<p>Why is Master in charge of all Coordination of the entire cluster?</p>
<ul>
<li>Broker actually acts as compute node with read/write operations. Coordination task of the state information is placed in the broker layer so that it is able to access the state information of all the storage nodes in the lower layer.</li>
<li>Metadata changes are frequent and are all lightweight;</li>
<li>Requires the computing ability to reduce query of a same database from multiple IDCs;</li>
</ul>
<p>What information needs to be processed?</p>
<ul>
<li>Database DDL operations;</li>
<li>Storage Node Management;</li>
<li>Runtime Parameter Adjustment;</li>
<li>Storage/Broker State Management;</li>
</ul>
<h2 id="overview" heading="2" href="#overview"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#overview"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Overview</a></h2>
<p><span class="not-prose flex flex-col text-center"><img src="/img/lindb/design/coordinator.png" alt="Coordinator" decoding="async" class="mx-auto"/><span class="mt-2 text-sm font-semibold italic">Coordinator</span></span></p>
<p>All scheduling operations are processed based on the basic framework logic of the figure above, each role listens for its own interested data change operations in ETCD.</p>
<ul>
<li>Each character spawns an asynchronous goroutine for the Metadata they care about to listen for changes via different keys in ETCD, each key is listened by separated goroutine;</li>
<li>When the listening key is changed, the corresponding goroutine submits the event to the event-queue in State Manager. Then the State Manager will start a global thread to process the change work of all events uniformly, and store the processed result in the State Manager&#x27;s State Store;</li>
<li>All external status information is obtained directly from the State Manager&#x27;s State Store without ETCD, so LinDB will still work when ETCD is down;</li>
</ul>
<h2 id="master" heading="2" href="#master"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#master"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Master</a></h2>
<p>The Master is responsible for most Metadata changes, it is elected from currently surviving Broker nodes by preemptively election. In brief, each Broker node registers the Master KEY concurrently, the first node will become Master;</p>
<p>At the same time, each Broker will also watch Master Key, If the information on Master Key is lost, the election will be re-initialized, so that each Broker will know who is the Master and able to forward requests to Master node;</p>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Master KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/master/node</span></span>
<span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Successfully Election KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/master/node/{broker node}</span></span>
<span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Post-Election Key</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/master/elected/{broker node}</span></span>
<span class="line"></span></code></pre>
<p>Master is responsible for the following state machines:</p>
<ol>
<li>Storage Config State Machine;</li>
<li>Database Config State Machine;</li>
<li>Shard Assignment State Machine;</li>
</ol>
<h3 id="storage-config" heading="3" href="#storage-config"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#storage-config"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Storage config</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/storage/config</span></span>
<span class="line"></span></code></pre>
<ul>
<li>The user can submit storage cluster configuration information to any broker node, then the Broker node just simply writes the configuration information to <strong>/storage/config/{cluster name}</strong></li>
<li>Master establishes a Storage-Live-Node State-Machine Watching mechanism for each Storage cluster based on the configuration information to trace the survival of each Storage cluster node;</li>
<li>Each Storage Cluster Watches the survival situation of Storage nodes, and write the overall storage status information to <strong>/state/storage/cluster/{cluster name}</strong> for usage by <a target="_self" href="/docs/lindb/design/coordinator#storage-state">Storage Cluster Status State Machine</a>;</li>
</ul>
<p>The Watch mechanism for each Storage Cluster is as follows:</p>
<ul>
<li>Establish connection with ETCD of the Storage cluster based on the configuration information of the Storage cluster;</li>
<li>Watch Storage cluster node survival KEY: <strong>/active/nodes</strong> (note that unlike brokers <strong>/active/nodes</strong>, it corresponds to the storage registration information);</li>
<li>When each Storage node starts, registers the node information below the corresponding KEY:  <strong>/live/nodes/{storage node id}</strong>;</li>
</ul>
<h3 id="database-config" heading="3" href="#database-config"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#database-config"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Database config</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/database/config</span></span>
<span class="line"></span></code></pre>
<ul>
<li>The user can submit the database DDL to any broker node, which broker will just write the configuration to ETCD;</li>
<li>Through the change of Watch KEY, the Master knows that it needs to assign the corresponding database, then generates a Shard Assignment according to the node status information of the current Storage cluster, and sends the Shard Assignment task to the corresponding nodes;</li>
</ul>
<div class="markdown-alert markdown-alert-tip" dir="auto">
<p class="markdown-alert-title" dir="auto"><svg class="octicon" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z"></path></svg>TIP</p>
<p>Shard Assignment : Describe the detail of each DataBase Shard;</p>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Name</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> Database Name;</span></span>
<span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Option</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> Configuration information for the storage engine;</span></span>
<span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Shards</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> Assignment information for each Shard;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Each Shard assignment includes the following information</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span></span>
<span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">ShardID</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> Shard&#x27;s ID;</span></span>
<span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Replicas</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> The information of all Replicas under the Shard corresponds to the information in the Node ID above;</span></span>
<span class="line"></span></code></pre>
</div>
<h3 id="shard-assignment" heading="3" href="#shard-assignment"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#shard-assignment"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Shard assignment</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/database/assign</span></span>
<span class="line"></span></code></pre>
<ul>
<li>Through watching this key, the Broker elects the leader of the corresponding data partition according to the current online node status of the target Storage cluster when the number of data shards changes, then sends the election result to the corresponding node;</li>
</ul>
<h3 id="storage-live-node" heading="3" href="#storage-live-node"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#storage-live-node"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Storage Live Node</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{storage namespace}/live/nodes</span></span>
<span class="line"></span></code></pre>
<p>By watching survival status of each node of the corresponding Storage cluster, broker controls whether the shard needs to re-elect a new Leader node, and traces the survival status of the current replica.</p>
<ul>
<li>When a shard leader was down, a new leader will be elected from currently surviving replica nodes. If no more replica node, the data shard will be marked as offline;</li>
<li>When a replica shard was down, then it will be removed from the list of surviving replicas;</li>
<li>When a new node was up, then it will be added to the list of surviving replicas, while the shard was already offline, this node will be elected as the new leader of this shard, then the shard will be marked as on-line again.</li>
</ul>
<h2 id="broker" heading="2" href="#broker"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#broker"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Broker</a></h2>
<p>Broker is responsible for the following state machines:</p>
<ol>
<li>Live Node State Machine;</li>
<li>Database Config State Machine;</li>
<li>Storage Status State Machine;</li>
</ol>
<h3 id="live-node" heading="3" href="#live-node"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#live-node"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Live node</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/live/nodes</span></span>
<span class="line"></span></code></pre>
<ul>
<li>When the Broker starts, it will register its own information under the Watch KEY: <strong>/live/nodes/{broker node}</strong>;</li>
<li>Through the Watch KEY, each broker knows which nodes are alive in the current broker cluster;</li>
</ul>
<h3 id="database-config" heading="3" href="#database-config"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#database-config"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Database config</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/database/config</span></span>
<span class="line"></span></code></pre>
<ul>
<li>Through this watch key，Broker knows every database configuration.</li>
</ul>
<h3 id="storage-state" heading="3" href="#storage-state"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#storage-state"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Storage state</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{broker namespace}/storage/state&quot;</span></span>
<span class="line"></span></code></pre>
<ul>
<li>Value of Watch KEY is written uniformly by the Master. The Master will watch the survival of each node in each Storage cluster, and write the final cluster information under the Watch KEY. For details, please refer to [Storage Live Node State Machine](# storage-live-node);</li>
<li>Through watching of this Watch KEY, overall status information of each Storage cluster will be known;</li>
<li>When processing a query request, this key will be used to obtain status information of the corresponding Storage node;</li>
<li>When processing a write request, this key will be used to obtain leader node of the target shard, then a corresponding data write channel will be established;</li>
</ul>
<h2 id="storage" heading="2" href="#storage"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#storage"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Storage</a></h2>
<p>Storage is responsible for the following state machines:</p>
<ol>
<li>Live Node State Machine;</li>
<li>Shard Assignment State Machine;</li>
</ol>
<h3 id="live-node" heading="3" href="#live-node"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#live-node"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Live node</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{storage namespace}/live/nodes</span></span>
<span class="line"></span></code></pre>
<ul>
<li>When Storage starts, it will register its own information under the Watch KEY, namely <code>/live/nodes/{storage node}</code>;</li>
<li>By watching of this KEY, each Storage knows which nodes are surviving in the current Storage cluster;</li>
</ul>
<h3 id="shard-assignment" heading="3" href="#shard-assignment"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#shard-assignment"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Shard assignment</a></h3>
<pre class="mt-0 grid p-3 shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml" style="background-color:#FAFAFA;--shiki-dark-bg:#1e293b;color:#90A4AE;--shiki-dark:#cad3f5" tabindex="0"><code class="language-yaml"><span class="line"><span style="color:#E53935;--shiki-dark:#8AADF4">Watch KEY</span><span style="color:#39ADB5;--shiki-dark:#8BD5CA">:</span><span style="color:#91B859;--shiki-dark:#A6DA95"> /{storage namespace}/database/assign</span></span>
<span class="line"></span></code></pre>
<ul>
<li>By watching of this KEY, Storage node knows whether a storage engine will be created to storage data locally;</li>
</ul>
<h2 id="fault-tolerance" heading="2" href="#fault-tolerance"><a class="group relative border-none lg:-ml-2 lg:pl-2" href="/docs/lindb/design/coordinator#fault-tolerance"><span class="absolute -ml-8 hidden items-center border-0 opacity-0 group-hover:opacity-100 group-focus:opacity-100 lg:flex">​<span class="flex size-6 items-center justify-center rounded-md text-slate-400 shadow-sm ring-1 ring-slate-900/5 hover:text-slate-700 hover:shadow hover:ring-slate-900/10 dark:bg-slate-800 dark:text-slate-400 dark:shadow-none dark:ring-0 dark:hover:bg-slate-700 dark:hover:text-slate-200"><svg width="12" height="12" fill="none" aria-hidden="true"><path d="M3.75 1v10M8.25 1v10M1 3.75h10M1 8.25h10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path></svg></span></span>Fault tolerance</a></h2>
<ul>
<li>ETCD is a very central component during the process, as all coordination and scheduling information is done by it;</li>
<li>Most Metadata is also stored in ETCD;</li>
</ul>
<p>So if the ETCD is down, there will be a big impact on the whole system, then how to minimize the impact is very important:</p>
<ol>
<li>Firstly, if ETCD is down, In the extreme case, the data corruption in the ETCD won&#x27;t be recovered. Therefore, the relevant node need to perform local backup operations after each Metadata change, and have the ability to restore the new data to new ETCD cluster;</li>
<li>ETCD failures should not affect the availability of the entire system;</li>
</ol>
<p>Negative Effect when ETCD is down:</p>
<ol>
<li>Affecting Metadata change, however this operation is low-frequency which is acceptable;</li>
<li>If the Shard Leader node is corrupted at the same time, data written to this node will be temporarily re-written to other Shards, and the data in this node cannot be read temporarily;</li>
<li>If the Shard Follower node is corrupted at the same time, which may affects the inconsistency of the replica data, but the data will be temporarily stored in the Leader node;</li>
</ol></div><div class="mt-12 border-t border-slate-200 pt-6 text-sm leading-6 dark:border-slate-800"><div class="mb-10 flex items-center font-semibold text-slate-700 dark:text-slate-200"><div><div class="ml-1 text-xs text-slate-900 dark:text-white">Previous</div><a target="_self" class="group flex items-center text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/architecture"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 text-slate-400 group-hover:text-slate-600 dark:group-hover:text-slate-300"><path fill-rule="evenodd" d="M7.72 12.53a.75.75 0 0 1 0-1.06l7.5-7.5a.75.75 0 1 1 1.06 1.06L9.31 12l6.97 6.97a.75.75 0 1 1-1.06 1.06l-7.5-7.5Z" clip-rule="evenodd"></path></svg>Architecture</a></div><div class="ml-auto text-right"><div class="mr-1 text-xs text-slate-900 dark:text-white">Next</div><a target="_self" class="group flex items-center text-slate-700 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/replication">Replication<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 text-slate-400 group-hover:text-slate-600 dark:group-hover:text-slate-300"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></a></div></div></div><div><div class="group fixed right-5 top-[4em] z-50 flex rounded bg-gray-200 p-1 shadow-md shadow-gray-200 ring-1 ring-gray-200 lg:right-6 lg:top-20 xl:hidden dark:bg-slate-800 dark:shadow-slate-600 dark:ring-slate-600" data-headlessui-state=""><button type="button" aria-expanded="false" data-headlessui-state=""><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-6 fill-gray-400 stroke-gray-400 dark:fill-slate-500 dark:shadow-slate-600"><path fill-rule="evenodd" d="M2.625 6.75a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875 0A.75.75 0 0 1 8.25 6h12a.75.75 0 0 1 0 1.5h-12a.75.75 0 0 1-.75-.75ZM2.625 12a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0ZM7.5 12a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 0 1.5h-12A.75.75 0 0 1 7.5 12Zm-4.875 5.25a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875 0a.75.75 0 0 1 .75-.75h12a.75.75 0 0 1 0 1.5h-12a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg></button></div><div hidden="" style="position:fixed;top:1px;left:1px;width:1px;height:0;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border-width:0;display:none"></div><div class="fixed bottom-0 right-[max(0px,calc(50%-45rem))] top-[3.8125rem] z-20 hidden w-[19.5rem] overflow-y-auto py-10 xl:block"><div class="px-2 xl:px-8"><h5 class="mb-2 text-sm font-semibold leading-6 text-slate-900 dark:text-slate-100">On this page</h5><ul class="text-sm leading-6 text-slate-700"><li><a target="_self" class="flex items-center gap-1 py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#overview">Overview</a></li><li><a target="_self" class="flex items-center gap-1 py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#master">Master</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#storage-config"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Storage config</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#database-config"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Database config</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#shard-assignment"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Shard assignment</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#storage-live-node"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Storage Live Node</a></li><li><a target="_self" class="flex items-center gap-1 py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#broker">Broker</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#live-node"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Live node</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#database-config"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Database config</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#storage-state"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Storage state</a></li><li><a target="_self" class="flex items-center gap-1 py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#storage">Storage</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#live-node"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Live node</a></li><li><a target="_self" class="flex items-center gap-1 py-1 ml-4 group flex items-start py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#shard-assignment"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="size-3"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg>Shard assignment</a></li><li><a target="_self" class="flex items-center gap-1 py-1 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="/docs/lindb/design/coordinator#fault-tolerance">Fault tolerance</a></li></ul><div class="border-t border-slate-200 pt-3 text-sm leading-6 text-slate-700 sm:flex dark:border-slate-200/5"><a target="_blank" class="flex items-center gap-2 hover:text-slate-900 dark:text-slate-400 dark:hover:text-slate-300" href="https://github.com/lindb/lindb.github.io/edit/main/docs/lindb/10-design/02-coordinator.mdx"><svg viewBox="0 0 16 16" class="size-4" fill="currentColor" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>Edit this page on Github</a></div></div></div></div><footer class="justify-self-end py-4 lg:pt-8"><div class="mx-auto max-w-8xl"><div class="mx-8 grid gap-4 sm:gap-8 lg:mx-0 lg:grid-cols-8 lg:gap-12 lg:px-8"><div class="col-span-4 mb-6 lg:mb-0"><p class="flex items-center gap-4 font-semibold italic text-slate-900 dark:text-slate-100">An open-source, cloud native, observabilty platform</p><p class="flex items-center gap-2 pt-3 lg:gap-5 lg:pt-6"><a target="_blank" class="block text-slate-600 hover:text-slate-700 dark:text-gray-200 dark:hover:text-slate-300" href="https://github.com/lindb/lindb"><span class="sr-only">LinDB on GitHub</span><svg viewBox="0 0 16 16" class="size-5" fill="currentColor" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg></a><a target="_blank" class="block text-slate-600 hover:text-slate-700 dark:text-gray-200 dark:hover:text-slate-300" href="https://x.com/lindb_io"><span class="sr-only">LinDB on Twitter</span><svg class="size-5" width="48" height="50" viewBox="0 0 48 50" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M28.5665 20.7714L46.4356 0H42.2012L26.6855 18.0355L14.2931 0H0L18.7397 27.2728L0 49.0548H4.23464L20.6196 30.0087L33.7069 49.0548H48L28.5655 20.7714H28.5665ZM22.7666 27.5131L5.76044 3.18778H12.2646L42.2032 46.012H35.699L22.7666 27.5142V27.5131Z" fill="currentColor"></path></svg></a></p></div><div class="col-span-2"><h3 class="mb-4 text-sm font-semibold text-slate-900 dark:text-slate-100">Open source</h3><ul><li class="mb-2"><a target="_blank" class="hover:text-stone-900 dark:hover:text-slate-300" href="https://github.com/lindb/linsight">Linsight</a></li><li class="mb-2"><a target="_blank" class="hover:text-stone-900 dark:hover:text-slate-300" href="https://github.com/lindb/lingo">Lingo</a></li><li class="mb-2"><a target="_self" class="hover:text-stone-900 dark:hover:text-slate-300" href="/oss/lindb">LinDB</a></li></ul></div><div class="col-span-2"><h3 class="mb-4 text-sm font-semibold text-slate-900 dark:text-slate-100">Resources</h3><ul><li class="mb-2"><a target="_self" class="hover:text-stone-900 dark:hover:text-slate-300" href="/docs/lindb/introduction">Documentation</a></li><li class="mb-2"><a target="_self" class="hover:text-stone-900 dark:hover:text-slate-300" href="/downloads/lindb">Downloads</a></li></ul></div></div><hr class="my-4 border-gray-200 dark:border-gray-700"/><span class="block text-center text-sm font-normal text-gray-600 dark:text-gray-400">Copyright © <!-- -->2024<!-- --> Lin Labs Inc. All Rights Reserved.</span></div></footer></div></div></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"page":{"path":"/docs/lindb/10-design/02-coordinator.mdx","meta":{"title":"Coordinator"},"title":"Coordinator","parent":"Design","commitInfo":{"author":"stone1100","date":"Mon Jun 24 07:03:27 2024"}},"source":{"compiledSource":"\"use strict\";\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = {\n    a: \"a\",\n    code: \"code\",\n    div: \"div\",\n    h2: \"h2\",\n    h3: \"h3\",\n    img: \"img\",\n    li: \"li\",\n    ol: \"ol\",\n    p: \"p\",\n    path: \"path\",\n    pre: \"pre\",\n    span: \"span\",\n    strong: \"strong\",\n    svg: \"svg\",\n    ul: \"ul\",\n    ..._provideComponents(),\n    ...props.components\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.p, {\n      children: \"All MetaData modification are mainly executed by three different roles in LinDB.\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Master\"\n        }), \": Execute all Metadata modification and delivery them to other components in the cluster through ETCD, and the Master is elected in Broker;\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Broker\"\n        }), \": Listens all states in the cluster;\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [_jsx(_components.strong, {\n          children: \"Storage\"\n        }), \": Listens status of the storage cluster where its located;\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Why is Master in charge of all Coordination of the entire cluster?\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Broker actually acts as compute node with read/write operations. Coordination task of the state information is placed in the broker layer so that it is able to access the state information of all the storage nodes in the lower layer.\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Metadata changes are frequent and are all lightweight;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Requires the computing ability to reduce query of a same database from multiple IDCs;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"What information needs to be processed?\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Database DDL operations;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Storage Node Management;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Runtime Parameter Adjustment;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Storage/Broker State Management;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Overview\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: _jsx(_components.img, {\n        src: \"/img/lindb/design/coordinator.png\",\n        alt: \"Coordinator\"\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"All scheduling operations are processed based on the basic framework logic of the figure above, each role listens for its own interested data change operations in ETCD.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Each character spawns an asynchronous goroutine for the Metadata they care about to listen for changes via different keys in ETCD, each key is listened by separated goroutine;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"When the listening key is changed, the corresponding goroutine submits the event to the event-queue in State Manager. Then the State Manager will start a global thread to process the change work of all events uniformly, and store the processed result in the State Manager's State Store;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"All external status information is obtained directly from the State Manager's State Store without ETCD, so LinDB will still work when ETCD is down;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Master\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The Master is responsible for most Metadata changes, it is elected from currently surviving Broker nodes by preemptively election. In brief, each Broker node registers the Master KEY concurrently, the first node will become Master;\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"At the same time, each Broker will also watch Master Key, If the information on Master Key is lost, the election will be re-initialized, so that each Broker will know who is the Master and able to forward requests to Master node;\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Master KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/master/node\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Successfully Election KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/master/node/{broker node}\"\n          })]\n        }), \"\\n\", _jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Post-Election Key\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/master/elected/{broker node}\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Master is responsible for the following state machines:\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Storage Config State Machine;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Database Config State Machine;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Shard Assignment State Machine;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Storage config\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/storage/config\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"The user can submit storage cluster configuration information to any broker node, then the Broker node just simply writes the configuration information to \", _jsx(_components.strong, {\n          children: \"/storage/config/{cluster name}\"\n        })]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Master establishes a Storage-Live-Node State-Machine Watching mechanism for each Storage cluster based on the configuration information to trace the survival of each Storage cluster node;\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Each Storage Cluster Watches the survival situation of Storage nodes, and write the overall storage status information to \", _jsx(_components.strong, {\n          children: \"/state/storage/cluster/{cluster name}\"\n        }), \" for usage by \", _jsx(_components.a, {\n          href: \"#storage-state\",\n          children: \"Storage Cluster Status State Machine\"\n        }), \";\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"The Watch mechanism for each Storage Cluster is as follows:\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Establish connection with ETCD of the Storage cluster based on the configuration information of the Storage cluster;\"\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"Watch Storage cluster node survival KEY: \", _jsx(_components.strong, {\n          children: \"/active/nodes\"\n        }), \" (note that unlike brokers \", _jsx(_components.strong, {\n          children: \"/active/nodes\"\n        }), \", it corresponds to the storage registration information);\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"When each Storage node starts, registers the node information below the corresponding KEY:  \", _jsx(_components.strong, {\n          children: \"/live/nodes/{storage node id}\"\n        }), \";\"]\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Database config\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/database/config\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"The user can submit the database DDL to any broker node, which broker will just write the configuration to ETCD;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Through the change of Watch KEY, the Master knows that it needs to assign the corresponding database, then generates a Shard Assignment according to the node status information of the current Storage cluster, and sends the Shard Assignment task to the corresponding nodes;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsxs(_components.div, {\n      className: \"markdown-alert markdown-alert-tip\",\n      dir: \"auto\",\n      children: [\"\\n\", _jsxs(_components.p, {\n        className: \"markdown-alert-title\",\n        dir: \"auto\",\n        children: [_jsx(_components.svg, {\n          className: \"octicon\",\n          viewBox: \"0 0 16 16\",\n          width: \"16\",\n          height: \"16\",\n          \"aria-hidden\": \"true\",\n          children: _jsx(_components.path, {\n            d: \"M8 1.5c-2.363 0-4 1.69-4 3.75 0 .984.424 1.625.984 2.304l.214.253c.223.264.47.556.673.848.284.411.537.896.621 1.49a.75.75 0 0 1-1.484.211c-.04-.282-.163-.547-.37-.847a8.456 8.456 0 0 0-.542-.68c-.084-.1-.173-.205-.268-.32C3.201 7.75 2.5 6.766 2.5 5.25 2.5 2.31 4.863 0 8 0s5.5 2.31 5.5 5.25c0 1.516-.701 2.5-1.328 3.259-.095.115-.184.22-.268.319-.207.245-.383.453-.541.681-.208.3-.33.565-.37.847a.751.751 0 0 1-1.485-.212c.084-.593.337-1.078.621-1.489.203-.292.45-.584.673-.848.075-.088.147-.173.213-.253.561-.679.985-1.32.985-2.304 0-2.06-1.637-3.75-4-3.75ZM5.75 12h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1 0-1.5ZM6 15.25a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 1 0 1.5h-2.5a.75.75 0 0 1-.75-.75Z\"\n          })\n        }), \"TIP\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Shard Assignment : Describe the detail of each DataBase Shard;\"\n      }), \"\\n\", _jsx(_components.pre, {\n        className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n        style: {\n          backgroundColor: \"#FAFAFA\",\n          \"--shiki-dark-bg\": \"#1e293b\",\n          color: \"#90A4AE\",\n          \"--shiki-dark\": \"#cad3f5\"\n        },\n        tabIndex: \"0\",\n        children: _jsxs(_components.code, {\n          className: \"language-yaml\",\n          children: [_jsxs(_components.span, {\n            className: \"line\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E53935\",\n                \"--shiki-dark\": \"#8AADF4\"\n              },\n              children: \"Name\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#39ADB5\",\n                \"--shiki-dark\": \"#8BD5CA\"\n              },\n              children: \":\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#91B859\",\n                \"--shiki-dark\": \"#A6DA95\"\n              },\n              children: \" Database Name;\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            className: \"line\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E53935\",\n                \"--shiki-dark\": \"#8AADF4\"\n              },\n              children: \"Option\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#39ADB5\",\n                \"--shiki-dark\": \"#8BD5CA\"\n              },\n              children: \":\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#91B859\",\n                \"--shiki-dark\": \"#A6DA95\"\n              },\n              children: \" Configuration information for the storage engine;\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            className: \"line\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E53935\",\n                \"--shiki-dark\": \"#8AADF4\"\n              },\n              children: \"Shards\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#39ADB5\",\n                \"--shiki-dark\": \"#8BD5CA\"\n              },\n              children: \":\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#91B859\",\n                \"--shiki-dark\": \"#A6DA95\"\n              },\n              children: \" Assignment information for each Shard;\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"line\"\n          }), \"\\n\", _jsxs(_components.span, {\n            className: \"line\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E53935\",\n                \"--shiki-dark\": \"#8AADF4\"\n              },\n              children: \"Each Shard assignment includes the following information\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#39ADB5\",\n                \"--shiki-dark\": \"#8BD5CA\"\n              },\n              children: \":\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            className: \"line\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E53935\",\n                \"--shiki-dark\": \"#8AADF4\"\n              },\n              children: \"ShardID\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#39ADB5\",\n                \"--shiki-dark\": \"#8BD5CA\"\n              },\n              children: \":\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#91B859\",\n                \"--shiki-dark\": \"#A6DA95\"\n              },\n              children: \" Shard's ID;\"\n            })]\n          }), \"\\n\", _jsxs(_components.span, {\n            className: \"line\",\n            children: [_jsx(_components.span, {\n              style: {\n                color: \"#E53935\",\n                \"--shiki-dark\": \"#8AADF4\"\n              },\n              children: \"Replicas\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#39ADB5\",\n                \"--shiki-dark\": \"#8BD5CA\"\n              },\n              children: \":\"\n            }), _jsx(_components.span, {\n              style: {\n                color: \"#91B859\",\n                \"--shiki-dark\": \"#A6DA95\"\n              },\n              children: \" The information of all Replicas under the Shard corresponds to the information in the Node ID above;\"\n            })]\n          }), \"\\n\", _jsx(_components.span, {\n            className: \"line\"\n          })]\n        })\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Shard assignment\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/database/assign\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Through watching this key, the Broker elects the leader of the corresponding data partition according to the current online node status of the target Storage cluster when the number of data shards changes, then sends the election result to the corresponding node;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Storage Live Node\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{storage namespace}/live/nodes\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"By watching survival status of each node of the corresponding Storage cluster, broker controls whether the shard needs to re-elect a new Leader node, and traces the survival status of the current replica.\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"When a shard leader was down, a new leader will be elected from currently surviving replica nodes. If no more replica node, the data shard will be marked as offline;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"When a replica shard was down, then it will be removed from the list of surviving replicas;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"When a new node was up, then it will be added to the list of surviving replicas, while the shard was already offline, this node will be elected as the new leader of this shard, then the shard will be marked as on-line again.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Broker\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Broker is responsible for the following state machines:\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Live Node State Machine;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Database Config State Machine;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Storage Status State Machine;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Live node\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/live/nodes\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"When the Broker starts, it will register its own information under the Watch KEY: \", _jsx(_components.strong, {\n          children: \"/live/nodes/{broker node}\"\n        }), \";\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Through the Watch KEY, each broker knows which nodes are alive in the current broker cluster;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Database config\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/database/config\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Through this watch key，Broker knows every database configuration.\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Storage state\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{broker namespace}/storage/state\\\"\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Value of Watch KEY is written uniformly by the Master. The Master will watch the survival of each node in each Storage cluster, and write the final cluster information under the Watch KEY. For details, please refer to [Storage Live Node State Machine](# storage-live-node);\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Through watching of this Watch KEY, overall status information of each Storage cluster will be known;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"When processing a query request, this key will be used to obtain status information of the corresponding Storage node;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"When processing a write request, this key will be used to obtain leader node of the target shard, then a corresponding data write channel will be established;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Storage\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Storage is responsible for the following state machines:\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Live Node State Machine;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Shard Assignment State Machine;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Live node\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{storage namespace}/live/nodes\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"When Storage starts, it will register its own information under the Watch KEY, namely \", _jsx(_components.code, {\n          children: \"/live/nodes/{storage node}\"\n        }), \";\"]\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"By watching of this KEY, each Storage knows which nodes are surviving in the current Storage cluster;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"Shard assignment\"\n    }), \"\\n\", _jsx(_components.pre, {\n      className: \"shiki shiki-themes material-theme-lighter catppuccin-macchiato language-yaml\",\n      style: {\n        backgroundColor: \"#FAFAFA\",\n        \"--shiki-dark-bg\": \"#1e293b\",\n        color: \"#90A4AE\",\n        \"--shiki-dark\": \"#cad3f5\"\n      },\n      tabIndex: \"0\",\n      children: _jsxs(_components.code, {\n        className: \"language-yaml\",\n        children: [_jsxs(_components.span, {\n          className: \"line\",\n          children: [_jsx(_components.span, {\n            style: {\n              color: \"#E53935\",\n              \"--shiki-dark\": \"#8AADF4\"\n            },\n            children: \"Watch KEY\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#39ADB5\",\n              \"--shiki-dark\": \"#8BD5CA\"\n            },\n            children: \":\"\n          }), _jsx(_components.span, {\n            style: {\n              color: \"#91B859\",\n              \"--shiki-dark\": \"#A6DA95\"\n            },\n            children: \" /{storage namespace}/database/assign\"\n          })]\n        }), \"\\n\", _jsx(_components.span, {\n          className: \"line\"\n        })]\n      })\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"By watching of this KEY, Storage node knows whether a storage engine will be created to storage data locally;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.h2, {\n      children: \"Fault tolerance\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"ETCD is a very central component during the process, as all coordination and scheduling information is done by it;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"Most Metadata is also stored in ETCD;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"So if the ETCD is down, there will be a big impact on the whole system, then how to minimize the impact is very important:\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Firstly, if ETCD is down, In the extreme case, the data corruption in the ETCD won't be recovered. Therefore, the relevant node need to perform local backup operations after each Metadata change, and have the ability to restore the new data to new ETCD cluster;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"ETCD failures should not affect the availability of the entire system;\"\n      }), \"\\n\"]\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"Negative Effect when ETCD is down:\"\n    }), \"\\n\", _jsxs(_components.ol, {\n      children: [\"\\n\", _jsx(_components.li, {\n        children: \"Affecting Metadata change, however this operation is low-frequency which is acceptable;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"If the Shard Leader node is corrupted at the same time, data written to this node will be temporarily re-written to other Shards, and the data in this node cannot be read temporarily;\"\n      }), \"\\n\", _jsx(_components.li, {\n        children: \"If the Shard Follower node is corrupted at the same time, which may affects the inconsistency of the replica data, but the data will be temporarily stored in the Leader node;\"\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = {\n    ..._provideComponents(),\n    ...props.components\n  };\n  return MDXLayout ? _jsx(MDXLayout, {\n    ...props,\n    children: _jsx(_createMdxContent, {\n      ...props\n    })\n  }) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}},"tocItems":[{"id":"overview","level":2,"title":"Overview"},{"id":"master","level":2,"title":"Master"},{"id":"storage-config","level":3,"title":"Storage config"},{"id":"database-config","level":3,"title":"Database config"},{"id":"shard-assignment","level":3,"title":"Shard assignment"},{"id":"storage-live-node","level":3,"title":"Storage Live Node"},{"id":"broker","level":2,"title":"Broker"},{"id":"live-node","level":3,"title":"Live node"},{"id":"database-config","level":3,"title":"Database config"},{"id":"storage-state","level":3,"title":"Storage state"},{"id":"storage","level":2,"title":"Storage"},{"id":"live-node","level":3,"title":"Live node"},{"id":"shard-assignment","level":3,"title":"Shard assignment"},{"id":"fault-tolerance","level":2,"title":"Fault tolerance"}],"releases":null,"sidebar":[{"index":2,"title":"Getting Started","children":[{"index":1,"title":"Docker","children":[],"href":"/docs/lindb/getting-started/docker"},{"index":2,"title":"Package","children":[],"href":"/docs/lindb/getting-started/package"}]},{"index":3,"title":"Developer Guide","children":[{"index":1,"title":"Connect","children":[],"href":"/docs/lindb/developer-guide/connect"},{"index":2,"title":"Create a database","children":[],"href":"/docs/lindb/developer-guide/create-database"},{"index":3,"title":"Insert data","children":[],"href":"/docs/lindb/developer-guide/insert-data"},{"index":4,"title":"Query data","children":[],"href":"/docs/lindb/developer-guide/query-data"}]},{"index":4,"title":"Deployment","children":[{"index":1,"title":"Kubernetes","children":[],"href":"/docs/lindb/deployment/kubernetes"},{"index":2,"title":"Manual deployment","children":[],"href":"/docs/lindb/deployment/manual"}]},{"index":5,"title":"Client","children":[{"index":1,"title":"CLI","children":[],"href":"/docs/lindb/client/cli"},{"index":2,"title":"Client libraries","children":[],"href":"/docs/lindb/client/client-libraries"},{"index":3,"title":"Go","children":[],"href":"/docs/lindb/client/go"},{"index":4,"title":"Java","children":[],"href":"/docs/lindb/client/java"}]},{"index":6,"title":"Lin Ql","children":[{"index":1,"title":"Lin query language","children":[],"href":"/docs/lindb/lin-ql/sql"}]},{"index":7,"title":"Admin Console","children":[{"index":1,"title":"Introduction","children":[],"href":"/docs/lindb/admin-console/index"},{"index":2,"title":"Cluster overview","children":[],"href":"/docs/lindb/admin-console/overview"},{"index":3,"title":"Data search","children":[],"href":"/docs/lindb/admin-console/search"},{"index":4,"title":"Data explore","children":[],"href":"/docs/lindb/admin-console/explore"},{"index":5,"title":"Cluster monitoring","children":[],"href":"/docs/lindb/admin-console/monitoring"},{"index":6,"title":"Metadata","children":[],"href":"/docs/lindb/admin-console/metadata"}]},{"index":8,"title":"Api","children":[{"index":1,"title":"Introduction","children":[],"href":"/docs/lindb/api/index"},{"index":2,"title":"Insert","children":[],"href":"/docs/lindb/api/insert"},{"index":3,"title":"Query","children":[],"href":"/docs/lindb/api/query"},{"index":4,"title":"State","children":[],"href":"/docs/lindb/api/state"}]},{"index":9,"title":"Reference","children":[{"index":1,"title":"Data Model","children":[],"href":"/docs/lindb/reference/data-model"},{"index":2,"title":"Metric","children":[],"href":"/docs/lindb/reference/metric"},{"index":3,"title":"Configuration","children":[],"href":"/docs/lindb/reference/configuration"}]},{"index":10,"title":"Design","children":[{"index":1,"title":"Architecture","children":[],"href":"/docs/lindb/design/architecture"},{"index":2,"title":"Coordinator","children":[],"href":"/docs/lindb/design/coordinator"},{"index":3,"title":"Replication","children":[],"href":"/docs/lindb/design/replication"},{"index":4,"title":"Query","children":[],"href":"/docs/lindb/design/query"},{"index":5,"title":"Storage","children":[],"href":"/docs/lindb/design/storage"},{"index":6,"title":"Memory database","children":[],"href":"/docs/lindb/design/memory-database"},{"index":7,"title":"Inverted index","children":[],"href":"/docs/lindb/design/inverted-index"}]}],"locale":"","_nextI18Next":{"initialI18nStore":{"en":{"translation":{"Lin Ql":"Lin QL","Api":"API"}}},"initialLocale":"en","ns":["translation"],"userConfig":null}},"__N_SSG":true},"page":"/docs/[[...slug]]","query":{"slug":["lindb","design","coordinator"]},"buildId":"-NtRW_Tocke_77ve0GfWf","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>