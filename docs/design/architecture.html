<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Architecture | LinDB</title>
    <meta name="description" content="A distributed time series database">
    <meta name="keywords" content="lindb tsdb">
  <link rel="shortcut icon" href="/images/logo.png">
  <link rel="stylesheet" type="text/css" href="//at.alicdn.com/t/font_1331329_he22yc3ekc6.css">
    
    <link rel="preload" href="/assets/css/0.styles.0b112324.css" as="style"><link rel="preload" href="/assets/js/app.83642c7e.js" as="script"><link rel="preload" href="/assets/js/2.0bd9a96c.js" as="script"><link rel="preload" href="/assets/js/12.ee420001.js" as="script"><link rel="prefetch" href="/assets/js/10.8b3f75a1.js"><link rel="prefetch" href="/assets/js/11.4c1753eb.js"><link rel="prefetch" href="/assets/js/13.489b9da1.js"><link rel="prefetch" href="/assets/js/14.691efa10.js"><link rel="prefetch" href="/assets/js/15.50b01a36.js"><link rel="prefetch" href="/assets/js/16.86cb79e5.js"><link rel="prefetch" href="/assets/js/17.ca020fbf.js"><link rel="prefetch" href="/assets/js/18.915c14ca.js"><link rel="prefetch" href="/assets/js/19.11fb3447.js"><link rel="prefetch" href="/assets/js/20.806a2e83.js"><link rel="prefetch" href="/assets/js/21.8ccbefc6.js"><link rel="prefetch" href="/assets/js/22.02a7ca36.js"><link rel="prefetch" href="/assets/js/23.fe69c27a.js"><link rel="prefetch" href="/assets/js/24.5e2d8ae7.js"><link rel="prefetch" href="/assets/js/25.e386c3be.js"><link rel="prefetch" href="/assets/js/26.f86751d6.js"><link rel="prefetch" href="/assets/js/27.3393481e.js"><link rel="prefetch" href="/assets/js/28.ba93dfd3.js"><link rel="prefetch" href="/assets/js/29.64b104ee.js"><link rel="prefetch" href="/assets/js/3.2fd9c01f.js"><link rel="prefetch" href="/assets/js/30.3b9524ec.js"><link rel="prefetch" href="/assets/js/31.1a5e4f14.js"><link rel="prefetch" href="/assets/js/32.0850880c.js"><link rel="prefetch" href="/assets/js/33.8d8b15ec.js"><link rel="prefetch" href="/assets/js/34.2414f515.js"><link rel="prefetch" href="/assets/js/35.8341d848.js"><link rel="prefetch" href="/assets/js/36.40c469f2.js"><link rel="prefetch" href="/assets/js/37.d28750eb.js"><link rel="prefetch" href="/assets/js/38.ba5e435c.js"><link rel="prefetch" href="/assets/js/39.2e28c367.js"><link rel="prefetch" href="/assets/js/4.82d2da6a.js"><link rel="prefetch" href="/assets/js/40.9f782ef6.js"><link rel="prefetch" href="/assets/js/41.5c025ca3.js"><link rel="prefetch" href="/assets/js/42.b12ace93.js"><link rel="prefetch" href="/assets/js/5.4de10e8c.js"><link rel="prefetch" href="/assets/js/6.a695ea9b.js"><link rel="prefetch" href="/assets/js/7.ee020972.js"><link rel="prefetch" href="/assets/js/8.30ee74ad.js"><link rel="prefetch" href="/assets/js/9.3f433fb3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.0b112324.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/images/logo.png" alt="LinDB" class="logo"> <span class="site-name can-hide">LinDB</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/introduction/overview.html" class="nav-link">Docs</a></div><div class="nav-item"><a href="/docs/community/contributor-guide.html" class="nav-link">Community</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/design/architecture.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/docs/design/architecture.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/lindb/lindb" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/introduction/overview.html" class="nav-link">Docs</a></div><div class="nav-item"><a href="/docs/community/contributor-guide.html" class="nav-link">Community</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/design/architecture.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/zh/docs/design/architecture.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/lindb/lindb" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Concept</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/introduction/overview.html" class="sidebar-link">Overview</a></li><li><a href="/docs/introduction/installation.html" class="sidebar-link">Installation</a></li><li><a href="/docs/introduction/comparision.html" class="sidebar-link">Comparision to Other TSDB</a></li><li><a href="/docs/introduction/roadmap.html" class="sidebar-link">RoadMap</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>User Guide</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/concept/datamodel.html" class="sidebar-link">Data Model</a></li><li><a href="/docs/concept/dtomodel.html" class="sidebar-link">DTO Model</a></li><li><a href="/docs/concept/fieldtype.html" class="sidebar-link">Field Type</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Design</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/design/architecture.html" class="active sidebar-link">Architecture</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/design/architecture.html#design-goals" class="sidebar-link">Design Goals</a></li><li class="sidebar-sub-header"><a href="/docs/design/architecture.html#overview" class="sidebar-link">Overview</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/design/architecture.html#broker" class="sidebar-link">Broker</a></li><li class="sidebar-sub-header"><a href="/docs/design/architecture.html#storage" class="sidebar-link">Storage</a></li><li class="sidebar-sub-header"><a href="/docs/design/architecture.html#etcd" class="sidebar-link">ETCD</a></li></ul></li></ul></li><li><a href="/docs/design/coordinator.html" class="sidebar-link">Coordinator</a></li><li><a href="/docs/design/replication.html" class="sidebar-link">Replication</a></li><li><a href="/docs/design/query.html" class="sidebar-link">Query</a></li><li><a href="/docs/design/memory.html" class="sidebar-link">Memory</a></li><li><a href="/docs/design/index_.html" class="sidebar-link">Index</a></li><li><a href="/docs/design/storage.html" class="sidebar-link">Storage</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="architecture"><a href="#architecture" class="header-anchor">#</a> Architecture</h1> <h2 id="design-goals"><a href="#design-goals" class="header-anchor">#</a> Design Goals</h2> <ul><li>Sufficiently simple for usability and serviceability;</li> <li>Support cluster mode;</li> <li>Support replication;</li> <li>Support multiple IDCs;</li> <li>Eventually Consistency;</li> <li>Self-monitoring ability;</li> <li>Self-governance ability;</li></ul> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p><img src="/assets/img/architecture.f407e202.png" alt="architecture"></p> <p>LinDB is mainly composed of several components：</p> <ol><li>Broker</li> <li>Storage</li> <li>ETCD</li></ol> <h3 id="broker"><a href="#broker" class="header-anchor">#</a> Broker</h3> <p>Broker is a stateless service with horizontal expansion capacity.</p> <p>Master is the node with special responsibilities of Broker, which executes the modification of Metadata.</p> <p>Each Broker node could be the Master, but Master node won't maintain or store too much Metadata. All Metadata is stored in ETCD, so the Master will be quickly freely elected from the Broker when problem occurs. The switch operation is automatically done by the system and the election process is preemptive.</p> <p>The main responsibilities of the Broker are as follows:</p> <ol><li>All read and write operations are exposed to the end-user, and the user will interacts with the Broker primarily;</li> <li>WAL Replication;</li> <li>Executing the user's query request and generating different execution plans according to the specific query conditions;</li> <li>Aggregating the data returned by Broker/Storage as the compute layer.</li> <li>Re-aggregating the query results of multiple IDCs.</li></ol> <h3 id="storage"><a href="#storage" class="header-anchor">#</a> Storage</h3> <p>Storage is also a stateless service which stores the data without the Metadata. Therefore, the Storage has the ability to scale horizontally. The main responsibilities are as follows:</p> <ol><li>Storing all data and index;</li> <li>Storing self's Metadata;</li> <li>Perform data filtering and simply aggregation operations(the most atomic aggregation calculation);</li> <li>Reporting self status periodically;</li></ol> <h3 id="etcd"><a href="#etcd" class="header-anchor">#</a> ETCD</h3> <p>ETCD is the only external dependency of the entire system, and which is designed as a weak dependency.
In other words, LinDB is capable of providing external services when ETCD is unavailable.</p> <p>The main responsibilities of ETCD are as follows:</p> <ol><li>Storing Metadata, such as database configuration, information about sharding, etc;</li> <li>Storing status information, such as the status of each node in the Broker/Storage cluster;</li> <li>Coordinator task state management: all changes to Metadata are sent to the Storage node through ETCD;</li></ol> <p>How to achieve the weak dependency of ETCD:</p> <ul><li>Prerequisites:
<ol><li>When ETCD is down, the is no modification of Metadata, such as not modifying the configuration of database;</li> <li>The cluster status is healthy, which means that the current Metadata/Status is available;</li></ol></li> <li>Status Reporting ability of Broker/Storage: when data in ETCD is unavailable or lost, Broker/Storage will report Metadata/Status to the new ETCD cluster;</li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/lindb/lindb.github.io/edit/dev/docs/docs/design/architecture.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">8/21/2021, 3:40:12 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/concept/fieldtype.html" class="prev">Field Type</a></span> <span class="next"><a href="/docs/design/coordinator.html">Coordinator</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.83642c7e.js" defer></script><script src="/assets/js/2.0bd9a96c.js" defer></script><script src="/assets/js/12.ee420001.js" defer></script>
  </body>
</html>
